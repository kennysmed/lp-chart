// LPChart v1.2
// 2013-07-02
function LPChart(){function H(e){var t=function(e){var t=[];var n,r,i,s;e.each(function(e){e.forEach(function(e){e=e.map(function(t,n){return[C.call(e,t,n),k.call(e,t,n)]});t.push(e)});n=d3.min(t,function(e){return d3.min(e,function(e){return e[0]})});r=d3.max(t,function(e){return d3.max(e,function(e){return e[0]})});if(E=="min"){i=d3.min(t,function(e){return d3.min(e,function(e){return e[1]})})}else{i=E}if(S=="max"){s=d3.max(t,function(e){return d3.max(e,function(e){return e[1]})})}else{s=S}});return{datasets:t,minX:n,maxX:r,minY:i,maxY:s}};C=function(e){return D[p].tickParser(e[0])};k=function(e){return P[d].tickParser(e[1])};L=D[p].scale;A=P[d].scale;O=D[p].tickFormat;M=P[d].tickFormat;T.scale(L).tickFormat(O).ticks(c);N.scale(A).tickFormat(M).ticks(h);if(v!==null){T.tickValues(v.map(function(e){return D[p].tickParser(e)}))}else{T.tickValues(null)}if(m!==null){N.tickValues(m.map(function(e){return P[d].tickParser(e)}))}else{N.tickValues(null)}var H=t(e);var B=H.datasets,j=H.minX,F=H.maxX,I=H.minY,q=H.maxY;var R=[j,F];if(p=="string"){R=B[0].map(function(e){return e[0]})}if(u.toString().substr(-1)=="%"){u=e[0][0].offsetWidth*(u.substr(0,u.length-1)/100)}r=0;i=0;s=0;o=0;if(g){o=12+T.tickPadding();if(!b){o+=_}}else{if(y){o=5}}if(y){s=7;r=20}else{s=1}var U=this[0][0];var z=d3.select(U).selectAll("svg").data([B]);var W=z.enter().append("svg").append("g");var X=z.select("g");var V=0;var $=0;var J=0;l=a-s-o;f=u-r-i;L.domain(R);if(p=="string"){L.rangePoints([0,f])}else{L.range([0,f])}A.domain([I,q]).range([l,0]);if(g){W.append("g").attr("class","axis axis-x");X.select(".axis-x").attr("transform","translate(0,"+A.range()[0]+")").call(T);var K=d3.select(U).select(".axis-x").select(".tick");var Q=K.node().getBBox().width;$=Q/2;var G=d3.select(d3.select(U).select(".axis-x").selectAll(".tick")[0].pop());var Y=G.node().getBBox().width;J=Y/2;X.select(".axis-x").remove()}if(y){W.append("g").attr("class","axis axis-y");X.select(".axis-y").call(N);var Z=0;d3.select(U).select(".axis-y").selectAll("text").each(function(){if(this.getBBox().width>Z)Z=this.getBBox().width});V=Z+N.tickPadding();if(!w){V+=yAxisTickSize}X.select(".axis-y").remove()}r=d3.max([V,$]);i=J;f=u-r-i;if(b){T.tickSize(-l,0,0)}else{T.tickSize(_,0,0)}if(p=="string"){L.rangePoints([0,f])}else{L.range([0,f])}if(g){W.append("g").attr("class","axis axis-x");X.select(".axis-x").attr("transform","translate(0,"+A.range()[0]+")").call(T)}if(w){N.tickSize(-f,0,0)}else{N.tickSize(yAxisTickSize,0,0)}A.range([l,0]);if(y){W.append("g").attr("class","axis axis-y");X.select(".axis-y").call(N)}z.attr("width",u).attr("height",a);if(x){var et=d3.svg.area().x(function(e){return L(e[0])}).y0(l).y1(function(e){return A(e[1])});X.selectAll(".area").data(B).enter().append("path").attr("class",function(e,t){return"area area-"+(t+1)}).attr("d",et)}else{X.selectAll(".line").data(B).enter().append("path").attr("class",function(e,t){return"line line-"+(t+1)}).attr("d",n)}X.attr("transform","translate("+r+","+s+")")}function B(e){return L(e[0])}function j(e){return A(e[1])}var e={date:d3.time.format("%Y-%m-%d").parse,hour:d3.time.format("%H:%M").parse,month:d3.time.format("%m").parse,numeric:function(e){return+e},string:function(e){return e},year:d3.time.format("%Y").parse,yearmonth:d3.time.format("%Y-%m").parse};var t={date:function(e){return d3.time.format("%e %b")(e)},hour:function(e){return d3.time.format("%H:%M")(e)},month:function(e){return d3.time.format("%b")(e)},numeric:function(e){return d3.format(",")(e)},string:function(e){return e},weekday:function(e){return d3.time.format("%a")(e)},year:function(e){return d3.time.format("%Y")(e)},yearmonth:function(e){return d3.time.format("%b %Y")(e)}};var n=d3.svg.line().x(B).y(j),r=0,i=0,s=0,o=0,u="100%",a=200,f=20,l=0,c=8,h=5,p="numeric",d="numeric",v=null,m=null,g=true,y=true,b=false,w=false,E=0,S="max",x=false,T=d3.svg.axis().orient("bottom"),N=d3.svg.axis().orient("left"),C=null,k=null,L=null,A=null,O=null,M=null,_=5;yAxisTickSize=5;var D={date:{scale:d3.time.scale(),tickFormat:t.date,tickParser:e.date},hour:{scale:d3.time.scale(),tickFormat:t.hour,tickParser:e.hour},month:{scale:d3.time.scale(),tickFormat:t.month,tickParser:e.month},numeric:{scale:d3.scale.linear(),tickFormat:t.numeric,tickParser:e.numeric},string:{scale:d3.scale.ordinal(),tickFormat:t.string,tickParser:e.string},weekday:{scale:d3.time.scale(),tickFormat:t.weekday,tickParser:e.date},year:{scale:d3.time.scale(),tickFormat:t.year,tickParser:e.year},yearmonth:{scale:d3.time.scale(),tickFormat:t.yearmonth,tickParser:e.yearmonth}};var P={numeric:{scale:d3.scale.linear(),tickFormat:t.numeric,tickParser:e.numeric}};H.xAxisType=function(e){if(!arguments.length)return p;if(e in D){p=e}return H};H.yAxisType=function(e){if(!arguments.length)return d;if(e in P){d=e}return H};H.width=function(e){if(!arguments.length)return u;u=e;return H};H.height=function(e){if(!arguments.length)return a;a=e;return H};H.xAxisTicks=function(e){if(!arguments.length)return c;c=e;return H};H.yAxisTicks=function(e){if(!arguments.length)return h;h=e;return H};H.showXAxis=function(e){if(!arguments.length)return g;g=e;return H};H.showYAxis=function(e){if(!arguments.length)return y;y=e;return H};H.showXAxisGrid=function(e){if(!arguments.length)return b;b=e;return H};H.showYAxisGrid=function(e){if(!arguments.length)return w;w=e;return H};H.xAxisTickValues=function(e){if(!arguments.length)return v;v=e;return H};H.yAxisTickValues=function(e){if(!arguments.length)return m;yTickValues=e;return H};H.yAxisMin=function(e){if(!arguments.length)return E;E=e;return H};H.yAxisMax=function(e){if(!arguments.length)return S;S=e;return H};H.fill=function(e){if(!arguments.length)return x;x=e;return H};H.x=function(e){if(!arguments.length)return C;C=e;return H};H.y=function(e){if(!arguments.length)return k;k=e;return H};return H}
