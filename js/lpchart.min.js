// LPChart v1.1.
// 2013-06-19
function LPChart(){function D(e){var t=function(e){var t=[];var n,r,i,s;e.each(function(e){e.forEach(function(e){e=e.map(function(t,n){return[T.call(e,t,n),N.call(e,t,n)]});t.push(e)});n=d3.min(t,function(e){return d3.min(e,function(e){return e[0]})});r=d3.max(t,function(e){return d3.max(e,function(e){return e[0]})});i=0;s=d3.max(t,function(e){return d3.max(e,function(e){return e[1]})})});return{datasets:t,minX:n,maxX:r,minY:i,maxY:s}};T=function(e){return M[p].tickParser(e[0])};N=function(e){return _[d].tickParser(e[1])};C=M[p].scale;k=_[d].scale;L=M[p].tickFormat;A=_[d].tickFormat;S.scale(C).tickFormat(L).ticks(c);x.scale(k).tickFormat(A).ticks(h);if(v!==null){S.tickValues(v.map(function(e){return M[p].tickParser(e)}))}else{S.tickValues(null)}if(m!==null){x.tickValues(m.map(function(e){return _[d].tickParser(e)}))}else{x.tickValues(null)}var D=t(e);var P=D.datasets,H=D.minX,B=D.maxX,j=D.minY,F=D.maxY;var I=[H,B];if(p=="string"){I=P[0].map(function(e){return e[0]})}if(u.toString().substr(-1)=="%"){u=e[0][0].offsetWidth*(u.substr(0,u.length-1)/100)}r=0;i=0;s=0;o=0;if(g){o=12+S.tickPadding();if(!b){o+=O}}else{if(y){o=5}}if(y){s=7;r=20}else{s=1}var q=this[0][0];var R=d3.select(q).selectAll("svg").data([P]);var U=R.enter().append("svg").append("g");var z=R.select("g");var W=0;var X=0;var V=0;l=a-s-o;f=u-r-i;C.domain(I);if(p=="string"){C.rangePoints([0,f])}else{C.range([0,f])}k.domain([0,F]).range([l,0]);if(g){U.append("g").attr("class","axis axis-x");z.select(".axis-x").attr("transform","translate(0,"+k.range()[0]+")").call(S);var $=d3.select(q).select(".axis-x").select(".tick");var J=$.node().getBBox().width;X=J/2;var K=d3.select(d3.select(q).select(".axis-x").selectAll(".tick")[0].pop());var Q=K.node().getBBox().width;V=Q/2;z.select(".axis-x").remove()}if(y){U.append("g").attr("class","axis axis-y");z.select(".axis-y").call(x);var G=0;d3.select(q).select(".axis-y").selectAll("text").each(function(){if(this.getBBox().width>G)G=this.getBBox().width});W=G+x.tickPadding();if(!w){W+=yAxisTickSize}z.select(".axis-y").remove()}r=d3.max([W,X]);i=V;f=u-r-i;if(b){S.tickSize(-l,0,0)}else{S.tickSize(O,0,0)}if(p=="string"){C.rangePoints([0,f])}else{C.range([0,f])}if(g){U.append("g").attr("class","axis axis-x");z.select(".axis-x").attr("transform","translate(0,"+k.range()[0]+")").call(S)}if(w){x.tickSize(-f,0,0)}else{x.tickSize(yAxisTickSize,0,0)}k.range([l,0]);if(y){U.append("g").attr("class","axis axis-y");z.select(".axis-y").call(x)}R.attr("width",u).attr("height",a);if(E){var Y=d3.svg.area().x(function(e){return C(e[0])}).y0(l).y1(function(e){return k(e[1])});z.selectAll(".area").data(P).enter().append("path").attr("class",function(e,t){return"area area-"+(t+1)}).attr("d",Y)}else{z.selectAll(".line").data(P).enter().append("path").attr("class",function(e,t){return"line line-"+(t+1)}).attr("d",n)}z.attr("transform","translate("+r+","+s+")")}function P(e){return C(e[0])}function H(e){return k(e[1])}var e={date:d3.time.format("%Y-%m-%d").parse,time:d3.time.format("%H:%M").parse,month:d3.time.format("%m").parse,numeric:function(e){return+e},string:function(e){return e},year:d3.time.format("%Y").parse,yearmonth:d3.time.format("%Y-%m").parse};var t={date:function(e){return d3.time.format("%e %b")(e)},time:function(e){return d3.time.format("%H:%M")(e)},month:function(e){return d3.time.format("%b")(e)},numeric:function(e){return d3.format(",")(e)},string:function(e){return e},weekday:function(e){return d3.time.format("%a")(e)},year:function(e){return d3.time.format("%Y")(e)},yearmonth:function(e){return d3.time.format("%b %Y")(e)}};var n=d3.svg.line().x(P).y(H),r=0,i=0,s=0,o=0,u="100%",a=200,f=20,l=0,c=8,h=5,p="numeric",d="numeric",v=null,m=null,g=true,y=true,b=false,w=false,E=false,S=d3.svg.axis().orient("bottom"),x=d3.svg.axis().orient("left"),T=null,N=null,C=null,k=null,L=null,A=null,O=5;yAxisTickSize=5;var M={date:{scale:d3.time.scale(),tickFormat:t.date,tickParser:e.date},time:{scale:d3.time.scale(),tickFormat:t.time,tickParser:e.time},month:{scale:d3.time.scale(),tickFormat:t.month,tickParser:e.month},numeric:{scale:d3.scale.linear(),tickFormat:t.numeric,tickParser:e.numeric},string:{scale:d3.scale.ordinal(),tickFormat:t.string,tickParser:e.string},weekday:{scale:d3.time.scale(),tickFormat:t.weekday,tickParser:e.date},year:{scale:d3.time.scale(),tickFormat:t.year,tickParser:e.year},yearmonth:{scale:d3.time.scale(),tickFormat:t.yearmonth,tickParser:e.yearmonth}};var _={numeric:{scale:d3.scale.linear(),tickFormat:t.numeric,tickParser:e.numeric}};D.xAxisType=function(e){if(!arguments.length)return p;if(e in M){p=e}return D};D.yAxisType=function(e){if(!arguments.length)return d;if(e in _){d=e}return D};D.width=function(e){if(!arguments.length)return u;u=e;return D};D.height=function(e){if(!arguments.length)return a;a=e;return D};D.xAxisTicks=function(e){if(!arguments.length)return c;c=e;return D};D.yAxisTicks=function(e){if(!arguments.length)return h;h=e;return D};D.showXAxis=function(e){if(!arguments.length)return g;g=e;return D};D.showYAxis=function(e){if(!arguments.length)return y;y=e;return D};D.showXAxisGrid=function(e){if(!arguments.length)return b;b=e;return D};D.showYAxisGrid=function(e){if(!arguments.length)return w;w=e;return D};D.xAxisTickValues=function(e){if(!arguments.length)return v;v=e;return D};D.yAxisTickValues=function(e){if(!arguments.length)return m;yTickValues=e;return D};D.fill=function(e){if(!arguments.length)return E;E=e;return D};D.x=function(e){if(!arguments.length)return T;T=e;return D};D.y=function(e){if(!arguments.length)return N;N=e;return D};return D}