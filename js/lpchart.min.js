// LPChart v1.3
// 2013-07-05
function LPChart(){function B(e){var t=function(e){var t=[];var n,r,i,s;e.each(function(e){e.forEach(function(e){e=e.map(function(t,n){return[k.call(e,t,n),L.call(e,t,n)]});t.push(e)});n=d3.min(t,function(e){return d3.min(e,function(e){return e[0]})});r=d3.max(t,function(e){return d3.max(e,function(e){return e[0]})});if(E=="min"){i=d3.min(t,function(e){return d3.min(e,function(e){return e[1]})})}else{i=E}if(S=="max"){s=d3.max(t,function(e){return d3.max(e,function(e){return e[1]})})}else{s=S}});return{datasets:t,minX:n,maxX:r,minY:i,maxY:s}};k=function(e){return P[p].tickParser(e[0])};L=function(e){return H[d].tickParser(e[1])};A=P[p].scale;O=H[d].scale;M=P[p].tickFormat;_=H[d].tickFormat;N.scale(A).tickFormat(M).ticks(c);C.scale(O).tickFormat(_).ticks(h);if(v!==null){N.tickValues(v.map(function(e){return P[p].tickParser(e)}))}else{N.tickValues(null)}if(m!==null){C.tickValues(m.map(function(e){return H[d].tickParser(e)}))}else{C.tickValues(null)}var B=t(e);var j=B.datasets,F=B.minX,I=B.maxX,q=B.minY,R=B.maxY;var U=[F,I];if(p=="string"){U=j[0].map(function(e){return e[0]})}if(u.toString().substr(-1)=="%"){u=e[0][0].offsetWidth*(u.substr(0,u.length-1)/100)}r=0;i=0;s=0;o=0;if(g){o=12+N.tickPadding();if(!b){o+=D}}else{if(y){o=5}}if(y){s=7;r=20}else{s=1}var z=this[0][0];var W=d3.select(z).selectAll("svg").data([j]);var X=W.enter().append("svg").append("g");var V=W.select("g");var $=0;var J=0;var K=0;var Q=0;l=a-s-o;f=u-r-i;A.domain(U);if(p=="string"){A.rangePoints([0,f])}else{A.range([0,f])}O.domain([q,R]).range([l,0]);if(g){X.append("g").attr("class","axis axis-x");V.select(".axis-x").attr("transform","translate(0,"+O.range()[0]+")").call(N);var G=d3.select(z).select(".axis-x").select(".tick");var Y=G.node().getBBox().width;K=Y/2;var Z=d3.select(d3.select(z).select(".axis-x").selectAll(".tick")[0].pop());var et=Z.node().getBBox().width;Q=et/2;V.select(".axis-x").remove()}if(y){var tt="0,0";if(x=="right"){tt=f+",0";C.orient("right")}X.append("g").attr("class","axis axis-y");V.select(".axis-y").attr("transform","translate("+tt+")").call(C);var nt=0;d3.select(z).select(".axis-y").selectAll("text").each(function(){if(this.getBBox().width>nt)nt=this.getBBox().width});if(x=="right"){J=nt+C.tickPadding();if(!w){J+=yAxisTickSize}}else{$=nt+C.tickPadding();if(!w){$+=yAxisTickSize}}V.select(".axis-y").remove()}r=d3.max([$,K]);i=d3.max([J,Q]);f=u-r-i;if(b){N.tickSize(-l,0,0)}else{N.tickSize(D,0,0)}if(p=="string"){A.rangePoints([0,f])}else{A.range([0,f])}if(g){X.append("g").attr("class","axis axis-x");V.select(".axis-x").attr("transform","translate(0,"+O.range()[0]+")").call(N)}if(w){C.tickSize(-f,0,0)}else{C.tickSize(yAxisTickSize,0,0)}if(x=="right"){tt=f+",0"}O.range([l,0]);if(y){X.append("g").attr("class","axis axis-y");V.select(".axis-y").attr("transform","translate("+tt+")").call(C)}W.attr("width",u).attr("height",a);if(T){var rt=d3.svg.area().x(function(e){return A(e[0])}).y0(l).y1(function(e){return O(e[1])});V.selectAll(".area").data(j).enter().append("path").attr("class",function(e,t){return"area area-"+(t+1)}).attr("d",rt)}else{V.selectAll(".line").data(j).enter().append("path").attr("class",function(e,t){return"line line-"+(t+1)}).attr("d",n)}V.attr("transform","translate("+r+","+s+")")}function j(e){return A(e[0])}function F(e){return O(e[1])}var e={date:d3.time.format("%Y-%m-%d").parse,hour:d3.time.format("%H:%M").parse,month:d3.time.format("%m").parse,numeric:function(e){return+e},string:function(e){return e},year:d3.time.format("%Y").parse,yearmonth:d3.time.format("%Y-%m").parse};var t={date:function(e){return d3.time.format("%e %b")(e)},hour:function(e){return d3.time.format("%H:%M")(e)},month:function(e){return d3.time.format("%b")(e)},numeric:function(e){return d3.format(",")(e)},string:function(e){return e},weekday:function(e){return d3.time.format("%a")(e)},year:function(e){return d3.time.format("%Y")(e)},yearmonth:function(e){return d3.time.format("%b %Y")(e)}};var n=d3.svg.line().x(j).y(F),r=0,i=0,s=0,o=0,u="100%",a=200,f=20,l=0,c=8,h=5,p="numeric",d="numeric",v=null,m=null,g=true,y=true,b=false,w=false,E=0,S="max",x="left",T=false,N=d3.svg.axis().orient("bottom"),C=d3.svg.axis().orient("left"),k=null,L=null,A=null,O=null,M=null,_=null,D=5;yAxisTickSize=5;var P={date:{scale:d3.time.scale(),tickFormat:t.date,tickParser:e.date},hour:{scale:d3.time.scale(),tickFormat:t.hour,tickParser:e.hour},month:{scale:d3.time.scale(),tickFormat:t.month,tickParser:e.month},numeric:{scale:d3.scale.linear(),tickFormat:t.numeric,tickParser:e.numeric},string:{scale:d3.scale.ordinal(),tickFormat:t.string,tickParser:e.string},weekday:{scale:d3.time.scale(),tickFormat:t.weekday,tickParser:e.date},year:{scale:d3.time.scale(),tickFormat:t.year,tickParser:e.year},yearmonth:{scale:d3.time.scale(),tickFormat:t.yearmonth,tickParser:e.yearmonth}};var H={numeric:{scale:d3.scale.linear(),tickFormat:t.numeric,tickParser:e.numeric}};B.xAxisType=function(e){if(!arguments.length)return p;if(e in P){p=e}return B};B.yAxisType=function(e){if(!arguments.length)return d;if(e in H){d=e}return B};B.width=function(e){if(!arguments.length)return u;u=e;return B};B.height=function(e){if(!arguments.length)return a;a=e;return B};B.xAxisTicks=function(e){if(!arguments.length)return c;c=e;return B};B.yAxisTicks=function(e){if(!arguments.length)return h;h=e;return B};B.showXAxis=function(e){if(!arguments.length)return g;g=e;return B};B.showYAxis=function(e){if(!arguments.length)return y;y=e;return B};B.showXAxisGrid=function(e){if(!arguments.length)return b;b=e;return B};B.showYAxisGrid=function(e){if(!arguments.length)return w;w=e;return B};B.xAxisTickValues=function(e){if(!arguments.length)return v;v=e;return B};B.yAxisTickValues=function(e){if(!arguments.length)return m;yTickValues=e;return B};B.yAxisMin=function(e){if(!arguments.length)return E;E=e;return B};B.yAxisMax=function(e){if(!arguments.length)return S;S=e;return B};B.yAxisPosition=function(e){if(!arguments.length)return x;x=e;return B};B.fill=function(e){if(!arguments.length)return T;T=e;return B};B.x=function(e){if(!arguments.length)return k;k=e;return B};B.y=function(e){if(!arguments.length)return L;L=e;return B};return B}
